<!doctype html>
{% load static  %}
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Report</title>
  <style type="text/css">
    {% comment %} @font-face {
        font-family: 'THSarabunNew';
        src: url('{% static "/static/THSarabunNew.ttf" %}') format('truetype');
    }
    body {
        font-family: 'THSarabunNew';
    }
    .border { border: 1px solid black; }
    .px-4 { padding-left: 16px; padding-right: 16px; }
    .py-2 { padding-top: 8px; padding-bottom: 8px; }
    .bg-gray-100 { background-color: #f7fafc; }
    .bg-white { background-color: #fff; }
    .text-center { text-align: center; }
    .pl-8 { padding-left: 32px; }
    b { font-weight: bold; } {% endcomment %}
</style>

  <link rel="stylesheet" href="output1.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-200 min-h-screen max-h-screen">
  

<!-- start from -->
<div class=" mx-auto max-w-screen-2xl ">
    <div class="bg-white mx-10 pb-4 pt-5">
      <p class="flex justify-center text-black text-2xl ml-5 px-4 py-4 ">แบบรายงานผลการทวนสอบผลสัมฤทธิ์ โดย{% if form.is_teacher_form%}อาจารย์ {%else%}นักศึกษา {%endif%}</p>
      <div class="mx-20  border py-3 shadow-xl  ">
        
        
        <div class=" w-auto" >
            <div class="p-4 grid grid-cols-2 gap-2 mx-5 bg-white">
                <!-- ใส่ ชื่อวิชา รหัสวิชา ภาค ปี ชื่ออาจารย์ วันที่ประเมิน -->
                <p>วิชา: {{ form.course.name }}</p>
                <p>รหัสวิชา: {{ form.course.class_code }}</p>
                <p>ภาคการศึกษา: {{ form.template.semester }}</p>
                <p>ปีการศึกษา: {{ form.template.year_number }}</p>
                {% comment %} <p>วันที่เริ่ม: {{ form.start_date }}</p>
                <p>วันที่สิ้นสุด: {{ form.end_date }}</p>
                <p>สถานะ: {% if form.expired %} หมดอายุ {% else %} ใช้งานอยู่ {% endif %}</p> {% endcomment %}
              </div>
        </div>
        <h1 class="px-10 py-3 ">ผลการประเมิน </h1>
                <!-- start table ตารางแสดงรายงานประเมิน -->
                <table class="min-w-full bg-white border border-gray-300">
                    <thead>
                      <tr>
                        <th class="px-4 py-2 border-b">ประเด็นการประเมิน</th>
                        <th class="px-4 py-2 border-b"><h1 class="border-b ">บรรลุผลการเรียนรู้ ภายหลังเรียนรายวิชา</h1>
                            {% comment %} <h1>ค่าเฉลี่ยที่ได้</h1> {% endcomment %}
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                        <!-- ใส่ลูปแสดงข้อมูล หัวข้อใหญ่ -->
                        {% for main in assessment_items %}
                        {% if not main.template_select %}
                            <tr>
                                <td class="border px-4 py-2 bg-gray-100" colspan="1">
                                    <b>{{ forloop.counter }} {{ main.text }}</b>
                                    <th class="px-4 py-2 border-b"><h1 class="border-b ">{% if forloop.first %}{%else%}บรรลุผลการเรียนรู้ {{main.text}} {% endif %}</h1>
                                      {%if forloop.first %}ค่าเฉลี่ยที่ได้{%else%}<h1>ค่าเฉลี่ยที่ได้</h1>{%endif %}
                                </td>
                            </tr>
                            <!-- ใส่ลูปแสดงข้อมูล หัวข้อย่อย และคะแนน -->
                            {% if main.sub_items_with_avg %}
                                {% for sub in main.sub_items_with_avg %}
                                    <tr>
                                        <td class="border px-4 py-2 pl-8">
                                            {{ forloop.parentloop.counter }}.{{ forloop.counter }} {{ sub.text }}
                                        </td>
                                        <td class="border px-4 py-2 text-center">{{ sub.average_response|default:"N/A" }}</td>
                                    </tr>
                                {% endfor %}
                            {% endif %}
                            <!-- ค่าเฉลี่ยรวมของหัวข้อใหญ่ -->
                            <tr>
                                <td class="border px-4 py-2"><b>ค่าเฉลี่ยรวม</b></td>
                                <td class="border px-4 py-2 text-center">{{ main.overall_average|floatformat:2|default:"N/A" }}</td>
                            </tr>
                        {% endif %}
                    {% endfor %}
                    ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                        <tr><!-- หัวข้อ PLO เป็น static -->
                            <td class="border px-4 py-2  bg-gray-100" colspan="1"><b>ผลการเรียนรู้ของหลักสูตร (PLOs)</b></td>
                            <th class="px-4 py-2 border-b"><h1 class="border-b ">บรรลุผลการเรียนรู้ ภายหลังเรียนรายวิชา</h1>
                              <h1>ค่าเฉลี่ยที่ได้</h1>

                            {%for main in plo%}
                            {% if  main.template_select %}
                            <tr><!-- หัวข้อ PLO ใหญ่ -->
                                <td class="border px-4 py-2  bg-white" colspan="2"><b>PLO{{ forloop.counter }}: {{ main.template_select.text }}</b></td>
                          <tr><!-- ลูป plo หัวข้อย่อย -->
                            {% if main.sub_items_with_avg %}
                                {% for sub in main.sub_items_with_avg %}
                            <td class="border px-4 py-2 pl-8 "> {{ forloop.parentloop.counter }}.{{ forloop.counter }} {{ sub.template_select.text }}</td>
                            <td class="border px-4 py-2 text-center">{{ sub.average_response|floatformat:2|default:"N/A" }}</td>
                          </tr>
                                {% endfor %}
                            {% endif %}
                          {% comment %} <tr>
                            <td class="border px-4 py-2"><b>ค่าเฉลี่ยรวม</b></td>
                            <td class="border px-4 py-2 text-center">{{ overall_plo_average|floatformat:2|default:"N/A" }}</td>
                        </tr> {% endcomment %}
                        {% endif %}
                    {% endfor %}
                    </tr>

                    <!-- แสดงค่าเฉลี่ยรวมของทุกหัวข้อใหญ่ -->
                    <tr>
                        <td class="border px-4 py-2 bg-gray-100 ">ค่าเฉลี่ยรวมทุกรายการ (1-5)</td>
                        <td class="border px-4 py-2 text-center  bg-gray-100">{{ overall_plo_average|floatformat:2|default:"N/A" }}</td>
                        
                      </tr>
                    </tbody>
                  </table>
                <!-- end table -->

                  <div class="mt-5 pl-3 text-l"><b>6.ข้อเสนอแนะ/ความคิดเห็น</b></div>
                  <!-- ลูปแสดง text  -->
                  {% for c in comment  %}
                  <div class="border rounded  ">
                    <div class="p-5"> {{c.comment}} </div>
                  </div>
                  {% endfor  %}

          </div>
        </div>
    </div>
</div>
</div>

</body>

</html>